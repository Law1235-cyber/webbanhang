{% extends 'app/base.html' %} {% load static %} {% block banner-slider %}
<div
  id="carouselExampleDark"
  class="carousel carousel-dark slide shadow"
  data-bs-ride="carousel"
>
  <div class="carousel-indicators">
    {% for banner in banners %}
    <button
      type="button"
      data-bs-target="#carouselExampleDark"
      data-bs-slide-to="{{ forloop.counter0 }}"
      class="{% if forloop.first %}active{% endif %}"
      aria-current="{% if forloop.first %}true{% else %}false{% endif %}"
      aria-label="Slide {{ forloop.counter }}"
    ></button>
    {% endfor %}
  </div>

  <div class="carousel-inner" style="max-height: 450px">
    {% for banner in banners %}
    <div
      class="carousel-item {% if forloop.first %}active{% endif %}"
      data-bs-interval="4000"
    >
      <img
        src="{{ banner.image.url }}"
        class="d-block w-100"
        alt="{{ banner.name }}"
        style="height: 450px; object-fit: cover"
      />
    </div>
    {% endfor %}
  </div>

  <button
    class="carousel-control-prev"
    type="button"
    data-bs-target="#carouselExampleDark"
    data-bs-slide="prev"
  >
    <span
      class="carousel-control-prev-icon bg-dark rounded-circle p-3"
      aria-hidden="true"
      style="background-size: 50%"
    ></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button
    class="carousel-control-next"
    type="button"
    data-bs-target="#carouselExampleDark"
    data-bs-slide="next"
  >
    <span
      class="carousel-control-next-icon bg-dark rounded-circle p-3"
      aria-hidden="true"
      style="background-size: 50%"
    ></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>
{% endblock banner-slider %} 


{% block main-content %}

<style>
  .product-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: none;
    border-radius: 12px;
  }
  .product-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15) !important;
  }
  .product-img-container {
    height: 220px;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    padding: 15px;
  }
  .product-img-custom {
    max-height: 100%;
    max-width: 100%;
    object-fit: contain;
    transition: transform 0.3s;
  }
  .product-card:hover .product-img-custom {
    transform: scale(1.05);
  }

  /* CSS Danh mục */
  .category-card {
    border: 1px solid #eee;
    border-radius: 10px;
    transition: all 0.3s ease;
    background-color: #fff;
  }
  .category-card:hover {
    background-color: #f8f9fa;
    border-color: #dc3545;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
  }
  .category-link {
    text-decoration: none;
    color: #333;
  }
  .category-link:hover {
    color: #dc3545;
  }
</style>

<div class="container my-5">
  <div class="mb-5">
    <h4
      class="fw-bold text-uppercase text-secondary mb-4"
      style="
        letter-spacing: 1px;
        border-left: 5px solid #dc3545;
        padding-left: 15px;
      "
    >
      Danh mục
    </h4>
    <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-3">
      {% for cat in categories %}
      <div class="col">
        <a
          href="{% url 'product_tong' %}?category={{ cat.id }}"
          class="category-link"
        >
          <div class="card h-100 text-center p-3 category-card">
            <div
              class="card-body p-0 d-flex align-items-center justify-content-center"
              style="min-height: 50px"
            >
              <h6 class="fw-bold m-0">{{ cat.name }}</h6>
            </div>
          </div>
        </a>
      </div>
      {% endfor %}
    </div>
  </div>

  <h3
    class="text-center fw-bold mb-4 text-uppercase text-secondary"
    style="letter-spacing: 2px"
  >
    Sản phẩm mới nhất
  </h3>

  <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-5 g-4">
    {% for product in products|slice:":10" %}
    <div class="col">
      <div class="card h-100 shadow-sm product-card">
        <a
          href="{% url 'product_detail' pk=product.id %}"
          class="product-img-container"
        >
          <img
            class="product-img-custom animate__animated animate__fadeIn"
            src="{{ product.imageURL }}"
            alt="{{ product.name }}"
          />
        </a>

        <div class="card-body d-flex flex-column">
          <h6
            class="card-title text-center mb-2"
            style="
              height: 40px;
              overflow: hidden;
              display: -webkit-box;
              -webkit-line-clamp: 2;
              -webkit-box-orient: vertical;
            "
          >
            <a
              href="{% url 'product_detail' pk=product.id %}"
              class="text-decoration-none text-dark fw-bold"
            >
              {{product.name}}
            </a>
          </h6>

          <hr class="my-2 opacity-25" />

          <h5 class="text-danger text-center fw-bold mb-3 mt-auto">
            {{product.price|floatformat:0}}₫
          </h5>

          <div class="d-grid gap-2">
            <button
              data-product="{{ product.id }}"
              data-action="add"
              class="btn btn-outline-primary add-btn update-cart-btn btn-sm fw-bold"
            >
              <i class="bi bi-cart-plus"></i> Thêm vào giỏ
            </button>

            <div class="d-flex gap-2">
              <a
                class="btn btn-light border btn-sm flex-grow-1"
                href="{% url 'product_detail' pk=product.id %}"
                title="Xem chi tiết"
              >
                Xem chi tiết
              </a>
              <a class="btn btn-outline-danger btn-sm" href="{% url 'add_to_cart_and_redirect' pk=product.id %}" title="Mua ngay">
                <span style="font-size: 0.9rem;">&#10132;</span> Mua
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>
{% endblock main-content %}
